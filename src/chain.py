from src.fp import Fp
from src.fp2 import Fp2
from src.fp6 import Fp6
from src.utils import (
    sbb,
    mac,
    adc,
    wrapping_mul_u64,
    wrapping_sub_u64,
    CtOption,
    Choice,
    BLS_X,
    BLS_X_IS_NEGATIVE,
)
from src.scalar import Scalar
from src.fp12 import (
    Fp12,
)
from src.g1 import G1Affine
from src.g2 import G2Affine, G2Projective
from abc import ABC, abstractmethod


def square(x: Fp2, n):
    result = x
    for _ in range(n):
        result = result.square()
    return result


def chain_pm3div4(var0: Fp2):
    var1 = var0.square()  # /* 0 : 2 */
    var9 = var1 * var0  # /* 1 : 3 */
    var5 = var1.square()  # /* 2 : 4 */
    var2 = var9 * var1  # /* 3 : 5 */
    var7 = var5 * var9  # /* 4 : 7 */
    var10 = var2 * var5  # /* 5 : 9 */
    var13 = var7 * var5  # /* 6 : 11 */
    var4 = var10 * var5  # /* 7 : 13 */
    var8 = var13 * var5  # /* 8 : 15 */
    var15 = var4 * var5  # /* 9 : 17 */
    var11 = var8 * var5  # /* 10 : 19 */
    var3 = var15 * var5  # /* 11 : 21 */
    var12 = var11 * var5  # /* 12 : 23 */
    var1 = var4.square()  # /* 13 : 26 */
    var14 = var12 * var5  # /* 14 : 27 */
    var6 = var1 * var9  # /* 15 : 29 */
    var5 = var1 * var2  # /* 16 : 31 */
    #   17 : 106496
    var1 = square(var1, 12)
    #   29 : 106513
    var1 *= var15
    #   30 : 13633664
    var1 = square(var1, 7)
    #   37 : 13633679
    var1 *= var8
    #   38 : 218138864
    var1 = square(var1, 4)
    #   42 : 218138869
    var1 *= var2
    #   43 : 13960887616
    var1 = square(var1, 6)
    #   49 : 13960887623
    var1 *= var7
    #   50 : 1786993615744
    var1 = square(var1, 7)
    #   57 : 1786993615767
    var1 *= var12
    #   58 : 57183795704544
    var1 = square(var1, 5)
    #   63 : 57183795704575
    var1 *= var5
    #   64 : 228735182818300
    var1 = square(var1, 2)
    #   66 : 228735182818303
    var1 *= var9
    #   67 : 14639051700371392
    var1 = square(var1, 6)
    #   73 : 14639051700371405
    var1 *= var4
    #   74 : 936899308823769920
    var1 = square(var1, 6)
    #   80 : 936899308823769933
    var1 *= var4
    #   81 : 59961555764721275712
    var1 = square(var1, 6)
    #   87 : 59961555764721275721
    var1 *= var10
    #   88 : 479692446117770205768
    var1 = square(var1, 3)
    #   91 : 479692446117770205771
    var1 *= var9
    #   92 : 61400633103074586338688
    var1 = square(var1, 7)
    #   99 : 61400633103074586338701
    var1 *= var4
    #  100 : 982410129649193381419216
    var1 = square(var1, 4)
    #  104 : 982410129649193381419229
    var1 *= var4
    #  105 : 62874248297548376410830656
    var1 = square(var1, 6)
    #  111 : 62874248297548376410830671
    var1 *= var8
    #  112 : 4023951891043096090293162944
    var1 = square(var1, 6)
    #  118 : 4023951891043096090293162971
    var1 *= var14
    #  119 : 32191615128344768722345303768
    var1 = square(var1, 3)
    #  122 : 32191615128344768722345303769
    var1 *= var0
    #  123 : 8241053472856260792920397764864
    var1 = square(var1, 8)
    #  131 : 8241053472856260792920397764877
    var1 *= var4
    #  132 : 1054854844525601381493810913904256
    var1 = square(var1, 7)
    #  139 : 1054854844525601381493810913904279
    var1 *= var12
    #  140 : 33755355024819244207801949244936928
    var1 = square(var1, 5)
    #  145 : 33755355024819244207801949244936939
    var1 *= var13
    #  146 : 2160342721588431629299324751675964096
    var1 = square(var1, 6)
    #  152 : 2160342721588431629299324751675964109
    var1 *= var4
    #  153 : 138261934181659624275156784107261702976
    var1 = square(var1, 6)
    #  159 : 138261934181659624275156784107261703005
    var1 *= var6
    #  160 : 2212190946906553988402508545716187248080
    var1 = square(var1, 4)
    #  164 : 2212190946906553988402508545716187248089
    var1 *= var10
    #  165 : 566320882408077821031042187703343935510784
    var1 = square(var1, 8)
    #  173 : 566320882408077821031042187703343935510813
    var1 *= var6
    #  174 : 9061134118529245136496675003253502968173008
    var1 = square(var1, 4)
    #  178 : 9061134118529245136496675003253502968173021
    var1 *= var4
    #  179 : 1159825167171743377471574400416448379926146688
    var1 = square(var1, 7)
    #  186 : 1159825167171743377471574400416448379926146711
    var1 *= var12
    #  187 : 593830485591932609265446093013221570522187116032
    var1 = square(var1, 9)
    #  196 : 593830485591932609265446093013221570522187116051
    var1 *= var11
    #  197 : 2375321942367730437061784372052886282088748464204
    var1 = square(var1, 2)
    #  199 : 2375321942367730437061784372052886282088748464207
    var1 *= var9
    #  200 : 76010302155767373985977099905692361026839950854624
    var1 = square(var1, 5)
    #  205 : 76010302155767373985977099905692361026839950854631
    var1 *= var7
    #  206 : 9729318675938223870205068787928622211435513709392768
    var1 = square(var1, 7)
    #  213 : 9729318675938223870205068787928622211435513709392773
    var1 *= var2
    #  214 : 1245352790520092655386248804854863643063745754802274944
    var1 = square(var1, 7)
    #  221 : 1245352790520092655386248804854863643063745754802274953
    var1 *= var10
    #  222 : 79702578593285929944719923510711273156079728307345596992
    var1 = square(var1, 6)
    #  228 : 79702578593285929944719923510711273156079728307345597015
    var1 *= var12
    #  229 : 2550482514985149758231037552342760740994551305835059104480
    var1 = square(var1, 5)
    #  234 : 2550482514985149758231037552342760740994551305835059104509
    var1 *= var6
    #  235 : 81615440479524792263393201674968343711825641786721891344288
    var1 = square(var1, 5)
    #  240 : 81615440479524792263393201674968343711825641786721891344307
    var1 *= var11
    #  241 : 2611694095344793352428582453598986998778420537175100523017824
    var1 = square(var1, 5)
    #  246 : 2611694095344793352428582453598986998778420537175100523017843
    var1 *= var11
    #  247 : 668593688408267098221717108121340671687275657516825733892567808
    var1 = square(var1, 8)
    #  255 : 668593688408267098221717108121340671687275657516825733892567821
    var1 *= var4
    #  256 : 85579992116258188572379789839531605975971284162153693938248681088
    var1 = square(var1, 7)
    #  263 : 85579992116258188572379789839531605975971284162153693938248681109
    var1 *= var3
    #  264 : 43816955963524192549058452397840182259697297491022691296383324727808
    var1 = square(var1, 9)
    #  273 : 43816955963524192549058452397840182259697297491022691296383324727823
    var1 *= var8
    #  274 : 1402142590832774161569870476730885832310313519712726121484266391290336
    var1 = square(var1, 5)
    #  279 : 1402142590832774161569870476730885832310313519712726121484266391290349
    var1 *= var4
    #  280 : 11217140726662193292558963813847086658482508157701808971874131130322792
    var1 = square(var1, 3)
    #  283 : 11217140726662193292558963813847086658482508157701808971874131130322795
    var1 *= var9
    #  284 : 2871588026025521482895094736344854184571522088371663096799777569362635520
    var1 = square(var1, 8)
    #  292 : 2871588026025521482895094736344854184571522088371663096799777569362635535
    var1 *= var8
    #  293 : 22972704208204171863160757890758833476572176706973304774398220554901084280
    var1 = square(var1, 3)
    #  296 : 22972704208204171863160757890758833476572176706973304774398220554901084283
    var1 *= var9
    #  297 : 2940506138650133998484577010017130685001238618492583011122972231027338788224
    var1 = square(var1, 7)
    #  304 : 2940506138650133998484577010017130685001238618492583011122972231027338788233
    var1 *= var10
    #  305 : 1505539142988868607224103429128770910720634172668202501694961782285997459575296
    var1 = square(var1, 9)
    #  314 : 1505539142988868607224103429128770910720634172668202501694961782285997459575311
    var1 *= var8
    #  315 : 96354505151287590862342619464241338286120587050764960108477554066303837412819904
    var1 = square(var1, 6)
    #  321 : 96354505151287590862342619464241338286120587050764960108477554066303837412819925
    var1 *= var3
    #  322 : 6166688329682405815189927645711445650311717571248957446942563460243445594420475200
    var1 = square(var1, 6)
    #  328 : 6166688329682405815189927645711445650311717571248957446942563460243445594420475231
    var1 *= var5
    #  329 : 197334026549836986086077684662766260809974962279966638302162030727790259021455207392
    var1 = square(var1, 5)
    #  334 : 197334026549836986086077684662766260809974962279966638302162030727790259021455207423
    var1 *= var5
    #  335 : 6314688849594783554754485909208520345919198792958932425669184983289288288686566637536
    var1 = square(var1, 5)
    #  340 : 6314688849594783554754485909208520345919198792958932425669184983289288288686566637567
    var1 *= var5
    #  341 : 101035021593516536876071774547336325534707180687342918810706959732628612618985066201072
    var1 = square(var1, 4)
    #  345 : 101035021593516536876071774547336325534707180687342918810706959732628612618985066201085
    var1 *= var4
    #  346 : 808280172748132295008574196378690604277657445498743350485655677861028900951880529608680
    var1 = square(var1, 3)
    #  349 : 808280172748132295008574196378690604277657445498743350485655677861028900951880529608683
    var1 *= var9
    #  350 : 206919724223521867522194994272944794695080306047678297724327853532423398643681415579822848
    var1 = square(var1, 8)
    #  358 : 206919724223521867522194994272944794695080306047678297724327853532423398643681415579822869
    var1 *= var3
    #  359 : 26485724700610799042840959266936933720970279174102822108713965252150195026391221194217327232
    var1 = square(var1, 7)
    #  366 : 26485724700610799042840959266936933720970279174102822108713965252150195026391221194217327263
    var1 *= var5
    #  367 : 847543190419545569370910696541981879071048933571290307478846888068806240844519078214954472416
    var1 = square(var1, 5)
    #  372 : 847543190419545569370910696541981879071048933571290307478846888068806240844519078214954472447
    var1 *= var5
    #  373 : 27121382093425458219869142289343420130273565874281289839323100418201799707024610502878543118304
    var1 = square(var1, 5)
    #  378 : 27121382093425458219869142289343420130273565874281289839323100418201799707024610502878543118335
    var1 *= var5
    #  379 : 433942113494807331517906276629494722084377053988500637429169606691228795312393768046056689893360
    var1 = square(var1, 4)
    #  383 : 433942113494807331517906276629494722084377053988500637429169606691228795312393768046056689893375
    var1 *= var8
    #  384 : 6943073815916917304286500426071915553350032863816010198866713707059660724998300288736907038294000
    var1 = square(var1, 4)
    #  388 : 6943073815916917304286500426071915553350032863816010198866713707059660724998300288736907038294007
    var1 *= var7
    #  389 : 888713448437365414948672054537205190828804206568449305454939354503636572799782436958324100901632896
    var1 = square(var1, 7)
    #  396 : 888713448437365414948672054537205190828804206568449305454939354503636572799782436958324100901632927
    var1 *= var5
    #  397 : 28438830349995693278357505745190566106521734610190377774558059344116370329593037982666371228852253664
    var1 = square(var1, 5)
    #  402 : 28438830349995693278357505745190566106521734610190377774558059344116370329593037982666371228852253693
    var1 *= var6
    #  403 : 910042571199862184907440183846098115408695507526092088785857899011723850546977215445323879323272118176
    var1 = square(var1, 5)
    #  408 : 910042571199862184907440183846098115408695507526092088785857899011723850546977215445323879323272118207
    var1 *= var5
    #  409 : 29121362278395589917038085883075139693078256240834946841147452768375163217503270894250364138344707782624
    var1 = square(var1, 5)
    #  414 : 29121362278395589917038085883075139693078256240834946841147452768375163217503270894250364138344707782655
    var1 *= var5
    #  415 : 931883592908658877345218748258404470178504199706718298916718488588005222960104668616011652427030649044960
    var1 = square(var1, 5)
    #  420 : 931883592908658877345218748258404470178504199706718298916718488588005222960104668616011652427030649044991
    var1 *= var5
    #  421 : 29820274973077084075046999944268943045712134390614985565334991634816167134723349395712372877664980769439712
    var1 = square(var1, 5)
    #  426 : 29820274973077084075046999944268943045712134390614985565334991634816167134723349395712372877664980769439743
    var1 *= var5
    #  427 : 954248799138466690401503998216606177462788300499679538090719732314117348311147180662795932085279384622071776
    var1 = square(var1, 5)
    #  432 : 954248799138466690401503998216606177462788300499679538090719732314117348311147180662795932085279384622071807
    var1 *= var5
    #  433 : 30535961572430934092848127942931397678809225615989745218903031434051755145956709781209469826728940307906297824
    var1 = square(var1, 5)
    #  438 : 30535961572430934092848127942931397678809225615989745218903031434051755145956709781209469826728940307906297855
    var1 *= var5
    #  439 : 488575385158894945485570047086902362860947609855835923502448502944828082335307356499351517227663044926500765680
    var1 = square(var1, 4)
    #  443 : 488575385158894945485570047086902362860947609855835923502448502944828082335307356499351517227663044926500765693
    var1 *= var4
    #  444 : 31268824650169276511076483013561751223100647030773499104156704188468997269459670815958497102570434875296049004352
    var1 = square(var1, 6)
    #  450 : 31268824650169276511076483013561751223100647030773499104156704188468997269459670815958497102570434875296049004373
    var1 *= var3
    #  451 : 500301194402708424177223728216988019569610352492375985666507267015503956311354733055335953641126958004736784069968
    var1 = square(var1, 4)
    #  455 : 500301194402708424177223728216988019569610352492375985666507267015503956311354733055335953641126958004736784069973
    var1 *= var2
    #  456 : 1000602388805416848354447456433976039139220704984751971333014534031007912622709466110671907282253916009473568139946
    return var1.square()
